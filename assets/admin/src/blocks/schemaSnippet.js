/**
 * WordPress dependencies
 */
import { __ } from '@wordpress/i18n'
import { registerBlockType } from '@wordpress/blocks'
import { InspectorControls } from '@wordpress/block-editor'
import { ServerSideRender, TextControl } from '@wordpress/components'

/**
 * Internal dependencies
 */
import icon from '@blocks/icon'

export default () => {
	const keywords = [
		__( 'Schema', 'rank-math' ),
		__( 'Markup', 'rank-math' ),
		__( 'Structured Data', 'rank-math' ),
		__( 'Rich Snippet', 'rank-math' ),
		__( 'SEO', 'rank-math' ),
		__( 'Rank Math', 'rank-math' ),
		__( 'Yoast', 'rank-math' ),
	]

	registerBlockType( 'rank-math/rich-snippet', {
		title: __( 'Schema by Rank Math', 'rank-math' ),
		description: __(
			'Add the Schema generated by Rank Math anywhere on your page using this Block.',
			'rank-math'
		),
		category: 'rank-math-blocks',
		icon,
		keywords,
		attributes: {
			id: { default: rankMath.objectID },
		},
		edit: ( props ) => {
			const { setAttributes, attributes } = props
			const postID = attributes.id ? attributes.id : rankMath.objectID

			return (
				<div>
					<InspectorControls key={ 'inspector' }>
						<TextControl
							label={ __( 'Post ID', 'rank-math' ) }
							value={ postID }
							type="number"
							min={ 1 }
							step={ 1 }
							onChange={ ( nextID ) => {
								setAttributes( { id: nextID } )
							} }
						/>
					</InspectorControls>

					<ServerSideRender
						block="rank-math/rich-snippet"
						attributes={ attributes }
					/>
				</div>
			)
		},
	} )
}
